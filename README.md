# Знакомство с DAST

## Начальные условия
Аналогичны [SAST Labs](https://gitlab.basealt.space/kuznetsovam/sast-labs) и рекомендуют (хотя и не требуют) предварительного выполнения последних.

## Часть 1. Запуск фаззинга
[AFLplusplus](https://github.com/AFLplusplus/AFLplusplus) - фаззер с открытым исходным кодом, распространяющийся под лицензией Apache-2.0.

Для знакомства с процессом фаззинга предлагается запустить фаззинг-тестирование с помощью AFLplusplus для одной из двух утилит командной строки:
- Вариант 1. [tar](https://www.gnu.org/software/tar/) - утилита GNU Project для создания архивов
- Вариант 2. [gzip](https://www.gnu.org/software/gzip/) - утилита GNU Project для сжатия файлов

В ходе выполнения заданий 1 части у нас должны получиться следующие артефакты работы:
- скриншоты выполнения пунктов задания;
- скриншоты запущенного процесса AFLplusplus;
- директории input/ и out/ со входными и сгенерированными фаззером файлами.

### Настройка окружения
#### Установка AFLplusplus
Установим AFLplusplus и его зависимости:
```shell
sudo apt-get install AFLplusplus llvm15.0
```

#### Установка зависимостей проекта
Требуется найти исходный код выбранной утилиты (например, на https://git.altlinux.org/gears/) и подготовить окружение согалсно требованиям (для помощи можно воспользоваться spec-файлом, использующимся при сборке).

### Сборка с инструментацией
Для сборки под контролем компилятора AFLplusplus предлагается добавлять переменные окружения `CC=afl-clang-lto CXX=afl-clang-lto++` перед командами сборки, например:
```shell
CC=afl-clang-lto CXX=afl-clang-lto++ make
```
Требуется выполнить таким образом сборку выбранной утилиты.

### Запуск фаззинг-тестирования
Создадим директорию для входных данных:
```shell
mkdir input
```
Поскольку AFLplusplus требуется хотя бы один входной фазапуск утилиты производится надйл для запуска, создадим тестовый файл:
```shell
echo "test" > input/1
```
С помощью команды `afl-fuzz` запустим фаззинг нашей программы (изменив program на наш исполняемый файл: gzip или tar)
Используемые ключи и опции:
- `-i` - путь к директории со входным корпусом;
- `-o` - путь к директории результатов работы фаззера (будет создана, если ее не было).
- `[...program's cmdline...]` - опции запуска утилиты tar/gzip. Требуется определить опции, которые позволят выполнять запуск утилиты над произвольным файлом
- `@@` - поскольку обе утилиты получают на вход файлы, вместо @@ AFLplusplus будет подставлять автосгенерированное название этого файла
```shell
afl-fuzz -i input/ -o out/ -- ./program [...program's cmdline...] @@
```

### Итог 1 части
В ходе 1 части мы научились запускать фаззинг-тестирование для утилит командной строки.

## Changelog

* Mon Oct 07 2024 Alexander Kuznetsov <kuznetsovam@basealt.ru> 1.0
    - Добавлена 1 часть.
